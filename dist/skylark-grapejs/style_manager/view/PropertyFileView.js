/**
 * skylark-grapejs - A version of garpejs that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-grapejs/
 * @license MIT
 */
define(["skylark-underscore","skylark-backbone","./PropertyView"],function(e,t,i){"use strict";const s=t.$;return i.extend({templateInput(){const{pfx:e,em:t}=this;return`\n    <div class="${e}field ${e}file">\n      <div id='${e}input-holder'>\n        <div class="${e}btn-c">\n          <button class="${e}btn" id="${e}images" type="button">\n            ${t.t("styleManager.fileButton")}\n          </button>\n        </div>\n        <div style="clear:both;"></div>\n      </div>\n      <div id="${e}preview-box">\n        <div id="${e}preview-file"></div>\n        <div id="${e}close">&Cross;</div>\n      </div>\n    </div>\n    `},init(){const e=this.em;this.modal=e.get("Modal"),this.am=e.get("AssetManager"),this.events["click #"+this.pfx+"close"]="removeFile",this.events["click #"+this.pfx+"images"]="openAssetManager",this.delegateEvents()},onRender(){if(!this.$input){const e=this.model.getDefaultValue();this.$input=s(`<input placeholder="${e}">`)}this.$preview||(this.$preview=this.$el.find("#"+this.pfx+"preview-file")),this.$previewBox||(this.$previewBox=this.$el.find("#"+this.pfx+"preview-box")),this.setValue(this.componentValue,0)},clearCached(){i.prototype.clearCached.apply(this,arguments),this.$preview=null,this.$previewBox=null},setValue(e,t){i.prototype.setValue.apply(this,arguments),this.setPreviewView(e&&e!=this.model.getDefaultValue()),this.setPreview(e)},setPreviewView(e){const t=this.$previewBox;t&&t[e?"addClass":"removeClass"](`${this.pfx}show`),t&&t.css({display:e?"block":"none"})},spreadUrl(e){this.model.set("value",e),this.setPreviewView(1)},setPreview(e){const t=this.$preview;e=e&&e.indexOf("url(")<0?`url(${e})`:e,t&&t.css("background-image",e)},cleanValue(){this.setPreviewView(0),this.model.set({value:""},{silent:!0})},removeFile(...e){this.model.set("value",this.model.getDefaultValue()),i.prototype.cleanValue.apply(this,e),this.setPreviewView(0)},openAssetManager(t){const{em:i,modal:s}=this,l=i?i.get("Editor"):"";l&&l.runCommand("open-assets",{types:["image"],accept:"image/*",target:this.getTargetModel(),onClick(){},onDblClick(){},onSelect:t=>{s.close();const i=e.isString(t)?t:t.get("src");this.spreadUrl(i)}})}})});
//# sourceMappingURL=../../sourcemaps/style_manager/view/PropertyFileView.js.map
