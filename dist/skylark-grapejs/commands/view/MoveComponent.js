/**
 * skylark-grapejs - A version of garpejs that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-grapejs/
 * @license MIT
 */
define(["skylark-underscore","skylark-backbone","../../utils/mixins","./SelectComponent","./SelectPosition"],function(t,e,s,o,i){"use strict";const n=e.$;return t.extend({},i,o,{init(e){o.init.apply(this,arguments),t.bindAll(this,"initSorter","rollback","onEndMove"),this.opt=e,this.hoverClass=this.ppfx+"highlighter-warning",this.badgeClass=this.ppfx+"badge-warning",this.noSelClass=this.ppfx+"no-select"},enable(...t){o.enable.apply(this,t),this.getBadgeEl().addClass(this.badgeClass),this.getHighlighterEl().addClass(this.hoverClass);var e=this.$wrapper;e.css("cursor","move"),e.on("mousedown",this.initSorter),e.addClass(this.noSelClass)},toggleClipboard(){},initSorter(t){var e=n(t.target).data("model").get("draggable");e&&(this.cacheEl=null,this.startSelectPosition(t.target,this.frameEl.contentDocument),this.sorter.draggable=e,this.sorter.onEndMove=this.onEndMove.bind(this),this.stopSelectComponent(),this.$wrapper.on("mousedown",this.initSorter),s.on(this.getContentWindow(),"keydown",this.rollback))},initSorterFromModel(t){var e=t.get("draggable");if(e){this.cacheEl=null;var o=t.view.el;this.startSelectPosition(o,this.frameEl.contentDocument),this.sorter.draggable=e,this.sorter.onEndMove=this.onEndMoveFromModel.bind(this),this.stopSelectComponent(),s.on(this.getContentWindow(),"keydown",this.rollback)}},initSorterFromModels(t){this.cacheEl=null;const e=t[t.length-1],o=(this.em.get("currentFrame")||{}).model,i=e.getEl(o),n=i.ownerDocument;this.startSelectPosition(i,n,{onStart:this.onStart}),this.sorter.draggable=e.get("draggable"),this.sorter.toMove=t,this.sorter.onMoveClb=this.onDrag,this.sorter.onEndMove=this.onEndMoveFromModel.bind(this),this.stopSelectComponent(),s.on(this.getContentWindow(),"keydown",this.rollback)},onEndMoveFromModel(){s.off(this.getContentWindow(),"keydown",this.rollback)},onEndMove(){this.enable(),s.off(this.getContentWindow(),"keydown",this.rollback)},onSelect(t,e){},rollback(t,e){(27==(t.which||t.keyCode)||e)&&(this.sorter.moved=!1,this.sorter.endMove())},getBadgeEl(){return this.$badge||(this.$badge=n(this.getBadge())),this.$badge},getHighlighterEl(){return this.$hl||(this.$hl=n(this.canvas.getHighlighter())),this.$hl},stop(...t){o.stop.apply(this,t),this.getBadgeEl().removeClass(this.badgeClass),this.getHighlighterEl().removeClass(this.hoverClass),this.$wrapper.css("cursor","").unbind().removeClass(this.noSelClass)}})});
//# sourceMappingURL=../../sourcemaps/commands/view/MoveComponent.js.map
