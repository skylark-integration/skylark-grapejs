{"version":3,"sources":["device_manager/view/DevicesView.js"],"names":["define","_","Backbone","View","extend","template","events","change","[object Object]","o","this","config","em","ppfx","pStylePrefix","startAdd","listenTo","updateSelect","delegateEvents","devEl","devicesEl","val","set","getDeviceModel","device","name","get","collection","result","each","id","attributes","label","t","$el","el","html","undefined","deviceLabel","find","append","getOptions","className"],"mappings":";;;;;;;AAAAA,QACI,qBACA,oBACD,SAAUC,EAAGC,GACZ,aACA,OAAOA,EAASC,KAAKC,QACjBC,SAAUJ,EAAEI,SAAS,6aAWrBC,QAAUC,OAAQ,gBAClBC,WAAWC,GACPC,KAAKC,OAASF,EAAEE,WAChBD,KAAKE,GAAKF,KAAKC,OAAOC,GACtBF,KAAKG,KAAOH,KAAKC,OAAOG,cAAgB,GACxCJ,KAAKJ,OAAO,UAAYI,KAAKG,KAAO,aAAeH,KAAKK,SACxDL,KAAKM,SAASN,KAAKE,GAAI,gBAAiBF,KAAKO,cAC7CP,KAAKQ,kBAETV,aAEAA,eACI,IAAII,EAAKF,KAAKE,GACd,GAAIA,EAAI,CACJ,IAAIO,EAAQT,KAAKU,UACbC,EAAMF,EAAQA,EAAME,MAAQ,GAChCT,EAAGU,IAAI,SAAUD,KAGzBb,eACI,IAAII,EAAKF,KAAKE,GACVO,EAAQT,KAAKU,UACjB,GAAIR,GAAMA,EAAGW,gBAAkBJ,EAAO,CAClC,IAAIK,EAASZ,EAAGW,iBACZE,EAAOD,EAASA,EAAOE,IAAI,QAAU,GACzCP,EAAME,IAAII,KAGlBjB,aACI,MAAMmB,WAACA,EAAUf,GAAEA,GAAMF,KACzB,IAAIkB,EAAS,GAMb,OALAD,EAAWE,KAAKL,IACZ,MAAMC,KAACA,EAAIK,GAAEA,GAAMN,EAAOO,WACpBC,EAAQpB,GAAMA,EAAGqB,GAAKrB,EAAGqB,2BAA4BH,MAAUL,EACrEG,qBAA6BH,MAAWO,eAErCJ,GAEXpB,SACI,MAAMI,GAACA,EAAEC,KAAEA,EAAIqB,IAAEA,EAAGC,GAAEA,GAAMzB,KAQ5B,OAPAwB,EAAIE,KAAK1B,KAAK2B,WACVxB,KAAAA,EACAyB,YAAa1B,GAAMA,EAAGqB,GAAKrB,EAAGqB,EAAE,2BAEpCvB,KAAKU,UAAYc,EAAIK,SAAU1B,YAC/BH,KAAKU,UAAUoB,OAAO9B,KAAK+B,cAC3BN,EAAGO,aAAgB7B,aACZH","file":"../../../device_manager/view/DevicesView.js","sourcesContent":["define([\n    'skylark-underscore',\n    'skylark-backbone'\n], function (_, Backbone) {\n    'use strict';\n    return Backbone.View.extend({\n        template: _.template(`\n    <div class=\"<%= ppfx %>device-label\"><%= deviceLabel %></div>\n    <div class=\"<%= ppfx %>field <%= ppfx %>select\">\n      <span id=\"<%= ppfx %>input-holder\">\n        <select class=\"<%= ppfx %>devices\"></select>\n      </span>\n      <div class=\"<%= ppfx %>sel-arrow\">\n        <div class=\"<%= ppfx %>d-s-arrow\"></div>\n      </div>\n    </div>\n    <button style=\"display:none\" class=\"<%= ppfx %>add-trasp\">+</button>`),\n        events: { change: 'updateDevice' },\n        initialize(o) {\n            this.config = o.config || {};\n            this.em = this.config.em;\n            this.ppfx = this.config.pStylePrefix || '';\n            this.events['click .' + this.ppfx + 'add-trasp'] = this.startAdd;\n            this.listenTo(this.em, 'change:device', this.updateSelect);\n            this.delegateEvents();\n        },\n        startAdd() {\n        },\n        updateDevice() {\n            var em = this.em;\n            if (em) {\n                var devEl = this.devicesEl;\n                var val = devEl ? devEl.val() : '';\n                em.set('device', val);\n            }\n        },\n        updateSelect() {\n            var em = this.em;\n            var devEl = this.devicesEl;\n            if (em && em.getDeviceModel && devEl) {\n                var device = em.getDeviceModel();\n                var name = device ? device.get('name') : '';\n                devEl.val(name);\n            }\n        },\n        getOptions() {\n            const {collection, em} = this;\n            let result = '';\n            collection.each(device => {\n                const {name, id} = device.attributes;\n                const label = em && em.t && em.t(`deviceManager.devices.${ id }`) || name;\n                result += `<option value=\"${ name }\">${ label }</option>`;\n            });\n            return result;\n        },\n        render() {\n            const {em, ppfx, $el, el} = this;\n            $el.html(this.undefined({\n                ppfx,\n                deviceLabel: em && em.t && em.t('deviceManager.device')\n            }));\n            this.devicesEl = $el.find(`.${ ppfx }devices`);\n            this.devicesEl.append(this.getOptions());\n            el.className = `${ ppfx }devices-c`;\n            return this;\n        }\n    });\n});"]}