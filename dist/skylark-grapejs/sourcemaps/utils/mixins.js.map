{"version":3,"sources":["utils/mixins.js"],"names":["define","_","elProt","window","Element","prototype","matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","appendStyles","styles","opts","stls","isArray","length","href","shift","unique","document","querySelector","head","link","createElement","rel","prepand","insertBefore","firstChild","appendChild","upFirst","value","toUpperCase","toLowerCase","slice","isTextNode","el","nodeType","isCommentNode","getKeyCode","ev","which","keyCode","isTaggableNode","on","fn","split","Array","i","forEach","elem","addEventListener","off","removeEventListener","hasDnd","em","get","nativeDnD","getModel","$","model","isElement","data","getElRect","def","top","left","width","height","rectText","range","createRange","selectNode","getBoundingClientRect","detach","camelCase","values","filter","String","map","getKeyChar","fromCharCode","isEscKey","getElement","getEl","shallowDiff","objOrig","objNew","result","keysNew","keys","prop","hasOwnProperty","origValue","newValue","indexOf","isUndefined","normalizeFloat","step","valueDef","stepDecimals","isNaN","parseFloat","Math","floor","side","toString","toFixed","getPointerEvent","touches","getUnitFromValue","replace","capitalize","str","charAt","substring","getViewEl","__gjsv","setViewEl","view","isComponent","obj","toHTML","isRule","toCSS"],"mappings":"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","file":"../../utils/mixins.js","sourcesContent":["define(['skylark-underscore'], function (_) {\n    'use strict';\n    const elProt = window.Element.prototype;\n    const matches = elProt.matches || elProt.webkitMatchesSelector || elProt.mozMatchesSelector || elProt.msMatchesSelector;\n    const appendStyles = (styles, opts = {}) => {\n        const stls = _.isArray(styles) ? [...styles] : [styles];\n        if (stls.length) {\n            const href = stls.shift();\n            if (href && (!opts.unique || !document.querySelector(`link[href=\"${ href }\"]`))) {\n                const {head} = document;\n                const link = document.createElement('link');\n                link.href = href;\n                link.rel = 'stylesheet';\n                if (opts.prepand) {\n                    head.insertBefore(link, head.firstChild);\n                } else {\n                    head.appendChild(link);\n                }\n            }\n            appendStyles(stls);\n        }\n    };\n    const shallowDiff = (objOrig, objNew) => {\n        const result = {};\n        const keysNew = _.keys(objNew);\n        for (let prop in objOrig) {\n            if (objOrig.hasOwnProperty(prop)) {\n                const origValue = objOrig[prop];\n                const newValue = objNew[prop];\n                if (keysNew.indexOf(prop) >= 0) {\n                    if (origValue !== newValue) {\n                        result[prop] = newValue;\n                    }\n                } else {\n                    result[prop] = null;\n                }\n            }\n        }\n        for (let prop in objNew) {\n            if (objNew.hasOwnProperty(prop)) {\n                if (_.isUndefined(objOrig[prop])) {\n                    result[prop] = objNew[prop];\n                }\n            }\n        }\n        return result;\n    };\n    const on = (el, ev, fn) => {\n        ev = ev.split(/\\s+/);\n        el = el instanceof Array ? el : [el];\n        for (let i = 0; i < ev.length; ++i) {\n            el.forEach(elem => elem.addEventListener(ev[i], fn));\n        }\n    };\n    const off = (el, ev, fn) => {\n        ev = ev.split(/\\s+/);\n        el = el instanceof Array ? el : [el];\n        for (let i = 0; i < ev.length; ++i) {\n            el.forEach(elem => elem.removeEventListener(ev[i], fn));\n        }\n    };\n    const getUnitFromValue = value => {\n        return value.replace(parseFloat(value), '');\n    };\n    const upFirst = value => value[0].toUpperCase() + value.toLowerCase().slice(1);\n    const camelCase = value => {\n        const values = value.split('-').filter(String);\n        return values[0].toLowerCase() + values.slice(1).map(upFirst);\n    };\n    const normalizeFloat = (value, step = 1, valueDef = 0) => {\n        let stepDecimals = 0;\n        if (isNaN(value))\n            return valueDef;\n        value = parseFloat(value);\n        if (Math.floor(value) !== value) {\n            const side = step.toString().split('.')[1];\n            stepDecimals = side ? side.length : 0;\n        }\n        return stepDecimals ? parseFloat(value.toFixed(stepDecimals)) : value;\n    };\n    const hasDnd = em => {\n        return 'draggable' in document.createElement('i') && (em ? em.get('Config').nativeDnD : 1);\n    };\n    const getElement = el => {\n        if (_.isElement(el) || isTextNode(el)) {\n            return el;\n        } else if (el && el.getEl) {\n            return el.getEl();\n        }\n    };\n    const isTextNode = el => el && el.nodeType === 3;\n    const isCommentNode = el => el && el.nodeType === 8;\n    const isTaggableNode = el => el && !isTextNode(el) && !isCommentNode(el);\n    const getModel = (el, $) => {\n        let model = el;\n        _.isElement(el) && (model = $(el).data('model'));\n        return model;\n    };\n    const getElRect = el => {\n        const def = {\n            top: 0,\n            left: 0,\n            width: 0,\n            height: 0\n        };\n        if (!el)\n            return def;\n        let rectText;\n        if (isTextNode(el)) {\n            const range = document.createRange();\n            range.selectNode(el);\n            rectText = range.getBoundingClientRect();\n            range.detach();\n        }\n        return rectText || (el.getBoundingClientRect ? el.getBoundingClientRect() : def);\n    };\n    const getPointerEvent = ev => ev.touches && ev.touches[0] ? ev.touches[0] : ev;\n    const getKeyCode = ev => ev.which || ev.keyCode;\n    const getKeyChar = ev => String.fromCharCode(getKeyCode(ev));\n    const isEscKey = ev => getKeyCode(ev) === 27;\n    const capitalize = str => str && str.charAt(0).toUpperCase() + str.substring(1);\n    const isComponent = obj => obj && obj.toHTML;\n    const isRule = obj => obj && obj.toCSS;\n    const getViewEl = el => el.__gjsv;\n    const setViewEl = (el, view) => {\n        el.__gjsv = view;\n    };\n    return {\n        isCommentNode: isCommentNode,\n        isTaggableNode: isTaggableNode,\n        on,\n        off,\n        hasDnd,\n        upFirst,\n        matches,\n        getModel,\n        getElRect,\n        camelCase,\n        isTextNode,\n        getKeyCode,\n        getKeyChar,\n        isEscKey,\n        getElement,\n        shallowDiff,\n        normalizeFloat,\n        getPointerEvent,\n        getUnitFromValue,\n        capitalize,\n        getViewEl,\n        setViewEl,\n        appendStyles,\n        isComponent,\n        isRule\n    };\n});"]}