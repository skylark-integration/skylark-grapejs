{"version":3,"sources":["commands/view/ShowOffset.js"],"names":["define","Backbone","a","b","$","getOffsetMethod","state","[object Object]","editor","sender","opts","opt","config","getConfig","zoom","this","em","getZoomDecimal","el","showOffsets","isTextNode","showOffsetsSelected","stopCommand","id","canvas","Canvas","pos","elPos","getElementPos","isUndefined","top","left","style","window","getComputedStyle","ppfx","stateVar","offsetViewer","view","opacity","marginT","marginB","marginL","marginR","padT","padB","padL","padR","childNodes","length","querySelector","stateLow","toLowerCase","marginName","paddingName","marginV","get","paddingV","fullMargName","fullPadName","appendChild","marginLeftSt","parseFloat","marginLeft","replace","marginRightSt","marginRight","marginTopSt","marginTop","marginBottomSt","marginBottom","mtStyle","mbStyle","mlStyle","mrStyle","ptStyle","pbStyle","plStyle","prStyle","posLeft","widthEl","width","height","marginSideH","marginSideT","padTop","paddingTop","padBot","paddingBottom","padSideH","padSideT","paddingLeft","padRight","paddingRight","method"],"mappings":"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","file":"../../../commands/view/ShowOffset.js","sourcesContent":["define([\n    'skylark-backbone',\n    'skylark-underscore',\n    '../../utils/mixins'\n], function (Backbone, a, b) {\n    'use strict';\n    const $ = Backbone.$;\n    return {\n        getOffsetMethod(state) {\n            var method = state || '';\n            return 'get' + method + 'OffsetViewerEl';\n        },\n        run(editor, sender, opts) {\n            var opt = opts || {};\n            var state = opt.state || '';\n            var config = editor.getConfig();\n            const zoom = this.em.getZoomDecimal();\n            const el = opt.el || '';\n            if (!config.showOffsets || b.isTextNode(el) || !config.showOffsetsSelected && state == 'Fixed') {\n                editor.stopCommand(this.id, opts);\n                return;\n            }\n            var canvas = editor.Canvas;\n            var pos = { ...opt.elPos || canvas.getElementPos(el) };\n            if (!a.isUndefined(opt.top)) {\n                pos.top = opt.top;\n            }\n            if (!a.isUndefined(opt.left)) {\n                pos.left = opt.left;\n            }\n            var style = window.getComputedStyle(el);\n            var ppfx = this.ppfx;\n            var stateVar = state + 'State';\n            var method = this.getOffsetMethod(state);\n            var offsetViewer = canvas[method](opts.view);\n            offsetViewer.style.opacity = '';\n            let marginT = this['marginT' + state];\n            let marginB = this['marginB' + state];\n            let marginL = this['marginL' + state];\n            let marginR = this['marginR' + state];\n            let padT = this['padT' + state];\n            let padB = this['padB' + state];\n            let padL = this['padL' + state];\n            let padR = this['padR' + state];\n            if (offsetViewer.childNodes.length) {\n                this[stateVar] = '1';\n                marginT = offsetViewer.querySelector('[data-offset-m-t]');\n                marginB = offsetViewer.querySelector('[data-offset-m-b]');\n                marginL = offsetViewer.querySelector('[data-offset-m-l]');\n                marginR = offsetViewer.querySelector('[data-offset-m-r]');\n                padT = offsetViewer.querySelector('[data-offset-p-t]');\n                padB = offsetViewer.querySelector('[data-offset-p-b]');\n                padL = offsetViewer.querySelector('[data-offset-p-l]');\n                padR = offsetViewer.querySelector('[data-offset-p-r]');\n            }\n            if (!this[stateVar]) {\n                var stateLow = state.toLowerCase();\n                var marginName = stateLow + 'margin-v';\n                var paddingName = stateLow + 'padding-v';\n                var marginV = $(`<div class=\"${ ppfx }marginName\">`).get(0);\n                var paddingV = $(`<div class=\"${ ppfx }paddingName\">`).get(0);\n                var marginEls = ppfx + marginName + '-el';\n                var paddingEls = ppfx + paddingName + '-el';\n                const fullMargName = `${ marginEls } ${ ppfx + marginName }`;\n                const fullPadName = `${ paddingEls } ${ ppfx + paddingName }`;\n                marginT = $(`<div class=\"${ fullMargName }-top\"></div>`).get(0);\n                marginB = $(`<div class=\"${ fullMargName }-bottom\"></div>`).get(0);\n                marginL = $(`<div class=\"${ fullMargName }-left\"></div>`).get(0);\n                marginR = $(`<div class=\"${ fullMargName }-right\"></div>`).get(0);\n                padT = $(`<div class=\"${ fullPadName }-top\"></div>`).get(0);\n                padB = $(`<div class=\"${ fullPadName }-bottom\"></div>`).get(0);\n                padL = $(`<div class=\"${ fullPadName }-left\"></div>`).get(0);\n                padR = $(`<div class=\"${ fullPadName }-right\"></div>`).get(0);\n                this['marginT' + state] = marginT;\n                this['marginB' + state] = marginB;\n                this['marginL' + state] = marginL;\n                this['marginR' + state] = marginR;\n                this['padT' + state] = padT;\n                this['padB' + state] = padB;\n                this['padL' + state] = padL;\n                this['padR' + state] = padR;\n                marginV.appendChild(marginT);\n                marginV.appendChild(marginB);\n                marginV.appendChild(marginL);\n                marginV.appendChild(marginR);\n                paddingV.appendChild(padT);\n                paddingV.appendChild(padB);\n                paddingV.appendChild(padL);\n                paddingV.appendChild(padR);\n                offsetViewer.appendChild(marginV);\n                offsetViewer.appendChild(paddingV);\n                this[stateVar] = '1';\n            }\n            var unit = 'px';\n            var marginLeftSt = parseFloat(style.marginLeft.replace(unit, '')) * zoom;\n            var marginRightSt = parseFloat(style.marginRight.replace(unit, '')) * zoom;\n            var marginTopSt = parseFloat(style.marginTop.replace(unit, '')) * zoom;\n            var marginBottomSt = parseFloat(style.marginBottom.replace(unit, '')) * zoom;\n            var mtStyle = marginT.style;\n            var mbStyle = marginB.style;\n            var mlStyle = marginL.style;\n            var mrStyle = marginR.style;\n            var ptStyle = padT.style;\n            var pbStyle = padB.style;\n            var plStyle = padL.style;\n            var prStyle = padR.style;\n            var posLeft = parseFloat(pos.left);\n            var widthEl = parseFloat(style.width) * zoom + unit;\n            mtStyle.height = marginTopSt + unit;\n            mtStyle.width = widthEl;\n            mtStyle.top = pos.top - marginTopSt + unit;\n            mtStyle.left = posLeft + unit;\n            mbStyle.height = marginBottomSt + unit;\n            mbStyle.width = widthEl;\n            mbStyle.top = pos.top + pos.height + unit;\n            mbStyle.left = posLeft + unit;\n            var marginSideH = pos.height + marginTopSt + marginBottomSt + unit;\n            var marginSideT = pos.top - marginTopSt + unit;\n            mlStyle.height = marginSideH;\n            mlStyle.width = marginLeftSt + unit;\n            mlStyle.top = marginSideT;\n            mlStyle.left = posLeft - marginLeftSt + unit;\n            mrStyle.height = marginSideH;\n            mrStyle.width = marginRightSt + unit;\n            mrStyle.top = marginSideT;\n            mrStyle.left = posLeft + pos.width + unit;\n            var padTop = parseFloat(style.paddingTop) * zoom;\n            ptStyle.height = padTop + unit;\n            var padBot = parseFloat(style.paddingBottom) * zoom;\n            pbStyle.height = padBot + unit;\n            var padSideH = pos.height - padBot - padTop + unit;\n            var padSideT = pos.top + padTop + unit;\n            plStyle.height = padSideH;\n            plStyle.width = parseFloat(style.paddingLeft) * zoom + unit;\n            plStyle.top = padSideT;\n            var padRight = parseFloat(style.paddingRight) * zoom;\n            prStyle.height = padSideH;\n            prStyle.width = padRight + unit;\n            prStyle.top = padSideT;\n        },\n        stop(editor, sender, opts = {}) {\n            var opt = opts || {};\n            var state = opt.state || '';\n            var method = this.getOffsetMethod(state);\n            var canvas = editor.Canvas;\n            var offsetViewer = canvas[method](opts.view);\n            offsetViewer.style.opacity = 0;\n        }\n    };\n});"]}