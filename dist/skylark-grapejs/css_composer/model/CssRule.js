/**
 * skylark-grapejs - A version of garpejs that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-grapejs/
 * @license MIT
 */
define(["skylark-underscore","skylark-backbone","../../domain_abstract/model/Styleable","../../selector_manager/model/Selectors"],function(e,t,s,r){"use strict";const{CSS:l}=window;return t.Model.extend(s).extend({defaults:{selectors:{},selectorsAdd:"",style:{},mediaText:"",state:"",stylable:!0,atRuleType:"",singleAtRule:0,important:0},initialize(e,t={}){this.config=e||{};const s=t.em;let l=this.config.selectors||[];if(this.em=s,s){const e=s.get("SelectorManager"),t=[];l.forEach(s=>{t.push(e.add(s))}),l=t}this.set("selectors",new r(l))},getAtRule(){const e=this.get("atRuleType"),t=this.get("mediaText"),s=e?`@${e}`:t?"@media":"";return s+(t&&s?` ${t}`:"")},selectorsToString(e={}){const t=[],{em:s}=this,r=this.get("state"),o=this.get("wrapper"),i=this.get("selectorsAdd"),a={escape:e=>l&&l.escape?l.escape(e):e},n=o&&s&&s.getConfig("wrapperIsBody")?"body":this.get("selectors").getFullString(0,a),c=r&&!e.skipState?`:${r}`:"";return n&&t.push(`${n}${c}`),i&&!e.skipAdd&&t.push(i),t.join(", ")},getDeclaration(e={}){let t="";const s=this.selectorsToString(),r=this.styleToString(e),l=this.get("singleAtRule");return(s||l)&&r&&(t=l?r:`${s}{${r}}`),t},toCSS(e={}){let t="";const s=this.getAtRule(),r=this.getDeclaration(e);return r&&(t=r),s&&t&&(t=`${s}{${t}}`),t},toJSON(...s){const r=t.Model.prototype.toJSON.apply(this,s);if(this.em.getConfig("avoidDefaults")){const t=this.defaults;e.forEach(t,(e,t)=>{r[t]===e&&delete r[t]}),e.isEmpty(r.selectors)&&delete r.selectors,e.isEmpty(r.style)&&delete r.style}return r},compare(t,s,r,l={}){var o=s||"",i=r||"",a=l.selectorsAdd||"",n=l.atRuleType||"";t instanceof Array||t.models||(t=[t]);var c=e.map(t.models||t,e=>e.get("name")),g=e.map(this.get("selectors").models,e=>e.get("name"));if(c.length!==g.length)return!1;for(var d=0;d<c.length;d++){for(var h=0,u=0;u<g.length;u++)c[d]===g[u]&&(h=1);if(0===h)return!1}return this.get("state")===o&&this.get("mediaText")===i&&this.get("selectorsAdd")===a&&this.get("atRuleType")===n}})});
//# sourceMappingURL=../../sourcemaps/css_composer/model/CssRule.js.map
